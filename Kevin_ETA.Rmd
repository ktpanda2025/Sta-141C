---
title: "Testing_song_ETA_Kevin"
author: "Kevin"
date: "2024-02-10"
output: html_document
---

```{r message=FALSE, warning=FALSE}
library(plotly)
library(tidyverse)
```

```{r}
Spotify_song_attributes <- read.csv("Spotify_audio_features.csv")
colnames(Spotify_song_attributes)
#can join on uri
```

```{r}
Spotify_data <- read.csv("New_Spspotify_chart_song_ranks.csv")
Spotify_charts = Spotify_data %>% 
  mutate(artist_names = str_trim(artist_names), WeekDate = as.Date(WeekDate)) 
```

```{r}
colnames(Spotify_charts)
```
```{r}
number_of_weeks_total_of_all_songs_charts = Spotify_charts %>% 
  group_by(artist_names) %>% 
  summarize(total = n())  
hist(x =number_of_weeks_total_of_all_songs_charts$total, main = "Number of weeks totla of all songs combined artsit has been on the charts")

number_of_weeks_total = Spotify_charts %>% 
  group_by(artist_names) %>% 
  summarize(total = n()) %>% 
  filter(total >300)


hist(x =number_of_weeks_total$total, main = "Number of weeks totla of all songs combined artsit has been on the charts,slightly cut down to see rest of rankings")
```

```{r}
total_streams = Spotify_charts %>%
  group_by(artist_names) %>%
  mutate(total_streams = sum(streams),total_weeks = n()) %>%
  select(artist_names, total_streams,total_weeks) %>% 
  distinct() %>% 
  arrange(desc(total_streams))
total_streams 
```




## Looking at indivisual artist 
```{r}
artist_trim_data = Spotify_charts %>%
  filter(artist_names == "Fuerza Regida")
```

```{r}
aa <- ggplot(data = artist_trim_data,aes(x= WeekDate ,y =streams,color = track_name)) + geom_line() +theme(legend.position = "none")
ggplotly(aa)
```
```{r}
total_streams = artist_trim_data %>%
  group_by(track_name) %>%
  mutate(total_streams = sum(streams),total_weeks = n()) %>%
  select(track_name, total_streams,total_weeks) %>% 
  distinct() %>%
  arrange(track_name)
```


```{r}

```



```{r}
combined_df = merge(x= artist_trim_data ,y = Spotify_song_attributes,by.x = "uri",by.y = "uri")

duplicate_rows <- duplicated(combined_df$track_name)

unique_combined_df <- combined_df[!duplicate_rows, ]
unique_combined_df <- merge(x= unique_combined_df,y =total_streams, by.x = "track_name",by.y ="track_name" )
head(unique_combined_df )
```
```{r}

```

```{r}
y_input = "speechiness"
x_input = "track_name"
size_input_1 = "total_streams"



ggplot(data = unique_combined_df, aes_string(y = y_input, x = x_input, size = size_input_1, color = size_input)) +
  geom_point(alpha = 0.7) +
  scale_size_continuous(range = c(3, 10)) +  # Adjust size range
  scale_color_viridis_c() +  # Add color scale
  labs(y = y_input, x = x_input, size = size_input_1, color = size_input_1) +
  theme_minimal()

```
```{r}
```

